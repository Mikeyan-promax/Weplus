# WePlus éƒ¨ç½²æŒ‡å—

> ğŸ“š å®Œæ•´çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿä¸Šçº¿ WePlus æ ¡å›­åŠ©æ‰‹åº”ç”¨

## ğŸ¯ éƒ¨ç½²æ¦‚è§ˆ

WePlus æ˜¯ä¸€ä¸ªåŸºäº Vite æ„å»ºçš„å•é¡µé¢åº”ç”¨ï¼ˆSPAï¼‰ï¼Œæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ã€‚æœ¬æŒ‡å—å°†è¯¦ç»†ä»‹ç»å„ç§éƒ¨ç½²é€‰é¡¹å’Œæœ€ä½³å®è·µã€‚

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. ç¯å¢ƒæ£€æŸ¥

ç¡®ä¿æ‚¨çš„å¼€å‘ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

```bash
# æ£€æŸ¥ Node.js ç‰ˆæœ¬
node --version  # >= 18.0.0

# æ£€æŸ¥ npm ç‰ˆæœ¬
npm --version   # >= 9.0.0
```

### 2. é¡¹ç›®æ„å»º

```bash
# å®‰è£…ä¾èµ–
npm install

# è¿è¡Œæ„å»º
npm run build

# é¢„è§ˆæ„å»ºç»“æœï¼ˆå¯é€‰ï¼‰
npm run preview
```

æ„å»ºå®Œæˆåï¼Œ`dist` ç›®å½•å°†åŒ…å«æ‰€æœ‰ç”Ÿäº§æ–‡ä»¶ï¼š

```
dist/
â”œâ”€â”€ index.html          # ä¸»é¡µé¢
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ index-[hash].js # JavaScript åŒ… (263.52 kB)
â”‚   â””â”€â”€ index-[hash].css # CSS åŒ… (49.24 kB)
â””â”€â”€ vite.svg           # é™æ€èµ„æº
```

## ğŸš€ éƒ¨ç½²é€‰é¡¹

### 1. é™æ€æ‰˜ç®¡å¹³å°

#### Vercel éƒ¨ç½² â­ æ¨è

Vercel æä¾›æœ€ä½³çš„å¼€å‘ä½“éªŒå’Œæ€§èƒ½ä¼˜åŒ–ï¼š

```bash
# å®‰è£… Vercel CLI
npm i -g vercel

# éƒ¨ç½²åˆ° Vercel
vercel

# ç”Ÿäº§éƒ¨ç½²
vercel --prod
```

**é…ç½®æ–‡ä»¶** (`vercel.json`):

```json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "framework": "vite",
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

#### Netlify éƒ¨ç½²

```bash
# å®‰è£… Netlify CLI
npm install -g netlify-cli

# éƒ¨ç½²åˆ° Netlify
netlify deploy

# ç”Ÿäº§éƒ¨ç½²
netlify deploy --prod
```

**é…ç½®æ–‡ä»¶** (`netlify.toml`):

```toml
[build]
  publish = "dist"
  command = "npm run build"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

#### GitHub Pages éƒ¨ç½²

1. åˆ›å»º GitHub Actions å·¥ä½œæµ (`.github/workflows/deploy.yml`):

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Build
      run: npm run build
    
    - name: Deploy
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./dist
```

2. é…ç½® `vite.config.ts` åŸºç¡€è·¯å¾„ï¼š

```typescript
export default defineConfig({
  base: '/your-repo-name/',
  // ... å…¶ä»–é…ç½®
})
```

### 2. CDN éƒ¨ç½²

#### é˜¿é‡Œäº‘ OSS

```bash
# å®‰è£…é˜¿é‡Œäº‘ CLI
npm install -g @alicloud/cli

# ä¸Šä¼ åˆ° OSS
ossutil cp -r dist/ oss://your-bucket-name/
```

#### è…¾è®¯äº‘ COS

```bash
# å®‰è£…è…¾è®¯äº‘ CLI
npm install -g coscmd

# é…ç½® COS
coscmd config

# ä¸Šä¼ æ–‡ä»¶
coscmd upload -r dist/ /
```

### 3. æœåŠ¡å™¨éƒ¨ç½²

#### Nginx é…ç½®

åˆ›å»º Nginx é…ç½®æ–‡ä»¶ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /var/www/weplus;
    index index.html;

    # å¯ç”¨ gzip å‹ç¼©
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

    # ç¼“å­˜é™æ€èµ„æº
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # SPA è·¯ç”±æ”¯æŒ
    location / {
        try_files $uri $uri/ /index.html;
    }

    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
    add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;
}
```

#### Apache é…ç½®

åˆ›å»º `.htaccess` æ–‡ä»¶ï¼š

```apache
RewriteEngine On
RewriteBase /

# å¤„ç† SPA è·¯ç”±
RewriteRule ^index\.html$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]

# å¯ç”¨å‹ç¼©
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# ç¼“å­˜è®¾ç½®
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
</IfModule>
```

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. æ„å»ºä¼˜åŒ–

åœ¨ `vite.config.ts` ä¸­é…ç½®ä¼˜åŒ–é€‰é¡¹ï¼š

```typescript
export default defineConfig({
  build: {
    // å¯ç”¨ä»£ç åˆ†å‰²
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          router: ['react-router-dom']
        }
      }
    },
    // å‹ç¼©é€‰é¡¹
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    }
  }
})
```

### 2. èµ„æºä¼˜åŒ–

- **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨ WebP æ ¼å¼ï¼Œå¯ç”¨æ‡’åŠ è½½
- **å­—ä½“ä¼˜åŒ–**: ä½¿ç”¨ `font-display: swap`
- **CSSä¼˜åŒ–**: ç§»é™¤æœªä½¿ç”¨çš„æ ·å¼

### 3. ç¼“å­˜ç­–ç•¥

```typescript
// Service Worker ç¼“å­˜é…ç½®
const CACHE_NAME = 'weplus-v1.0.0';
const urlsToCache = [
  '/',
  '/static/js/bundle.js',
  '/static/css/main.css'
];
```

## ğŸ”’ å®‰å…¨é…ç½®

### 1. HTTPS é…ç½®

ç¡®ä¿ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPSï¼š

```bash
# ä½¿ç”¨ Let's Encrypt è·å–å…è´¹è¯ä¹¦
certbot --nginx -d your-domain.com
```

### 2. å®‰å…¨å¤´é…ç½®

```nginx
# å®‰å…¨å¤´é…ç½®
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
```

### 3. å†…å®¹å®‰å…¨ç­–ç•¥ (CSP)

```html
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; 
               script-src 'self' 'unsafe-inline'; 
               style-src 'self' 'unsafe-inline'; 
               img-src 'self' data: https:;">
```

## ğŸ“Š ç›‘æ§å’Œåˆ†æ

### 1. æ€§èƒ½ç›‘æ§

é›†æˆ Google Analytics æˆ–å…¶ä»–åˆ†æå·¥å…·ï¼š

```typescript
// åœ¨ main.tsx ä¸­æ·»åŠ 
import { analytics } from './utils/analytics';

analytics.init('YOUR_TRACKING_ID');
```

### 2. é”™è¯¯ç›‘æ§

ä½¿ç”¨ Sentry è¿›è¡Œé”™è¯¯è¿½è¸ªï¼š

```bash
npm install @sentry/react @sentry/tracing
```

```typescript
import * as Sentry from "@sentry/react";

Sentry.init({
  dsn: "YOUR_SENTRY_DSN",
  integrations: [
    new Sentry.BrowserTracing(),
  ],
  tracesSampleRate: 1.0,
});
```

## ğŸ”„ CI/CD æµç¨‹

### GitHub Actions å®Œæ•´é…ç½®

```yaml
name: Build and Deploy

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
    - run: npm ci
    - run: npm run lint
    - run: npm run build

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
    - uses: actions/checkout@v3
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
    - run: npm ci
    - run: npm run build
    - name: Deploy to Vercel
      uses: amondnet/vercel-action@v20
      with:
        vercel-token: ${{ secrets.VERCEL_TOKEN }}
        vercel-org-id: ${{ secrets.ORG_ID }}
        vercel-project-id: ${{ secrets.PROJECT_ID }}
        vercel-args: '--prod'
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. è·¯ç”±é—®é¢˜

**é—®é¢˜**: åˆ·æ–°é¡µé¢å‡ºç° 404 é”™è¯¯

**è§£å†³**: é…ç½®æœåŠ¡å™¨é‡å†™è§„åˆ™ï¼Œå°†æ‰€æœ‰è¯·æ±‚é‡å®šå‘åˆ° `index.html`

### 2. èµ„æºåŠ è½½é—®é¢˜

**é—®é¢˜**: é™æ€èµ„æºåŠ è½½å¤±è´¥

**è§£å†³**: æ£€æŸ¥ `base` é…ç½®å’Œèµ„æºè·¯å¾„

### 3. ç¼“å­˜é—®é¢˜

**é—®é¢˜**: æ›´æ–°åç”¨æˆ·çœ‹ä¸åˆ°æ–°ç‰ˆæœ¬

**è§£å†³**: é…ç½®æ­£ç¡®çš„ç¼“å­˜å¤´å’Œç‰ˆæœ¬æ§åˆ¶

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

### æ„å»ºäº§ç‰©å¤§å°

- **JavaScript**: 263.52 kB (gzip: 82.92 kB)
- **CSS**: 49.24 kB (gzip: 9.41 kB)
- **æ€»å¤§å°**: 313.42 kB (gzip: 92.62 kB)

### æ€§èƒ½æŒ‡æ ‡

- **é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)**: < 1.5s
- **æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP)**: < 2.5s
- **é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID)**: < 100ms
- **ç´¯ç§¯å¸ƒå±€åç§» (CLS)**: < 0.1

## ğŸ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼æ‚¨å·²æˆåŠŸéƒ¨ç½² WePlus æ ¡å›­åŠ©æ‰‹åº”ç”¨ã€‚

### éªŒè¯æ¸…å•

- [ ] åº”ç”¨å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰è·¯ç”±å·¥ä½œæ­£å¸¸
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸
- [ ] ç§»åŠ¨ç«¯é€‚é…è‰¯å¥½
- [ ] HTTPS é…ç½®æ­£ç¡®
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡

### åç»­ç»´æŠ¤

1. **å®šæœŸæ›´æ–°**: ä¿æŒä¾èµ–åŒ…æœ€æ–°
2. **æ€§èƒ½ç›‘æ§**: å…³æ³¨ç”¨æˆ·ä½“éªŒæŒ‡æ ‡
3. **å®‰å…¨æ›´æ–°**: åŠæ—¶ä¿®å¤å®‰å…¨æ¼æ´
4. **å¤‡ä»½ç­–ç•¥**: å®šæœŸå¤‡ä»½é‡è¦æ•°æ®

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** è¯·æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£æˆ–æäº¤ Issueã€‚